[
 {
  "docstatus": 0,
  "doctype": "Custom Script",
  "dt": "Sensor Group",
  "modified": "2020-12-23 12:56:44.868008",
  "name": "Sensor Group-Client",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sensor Group', {\n\tonload(frm) {\n\t  // your code here\n\t  var template = '';\n\t  if (frm.doc.route && frm.doc.published) {\n\t    template = '<h4><a style=\"color: #4682b4; font-size: 10pt;\" href=\"' + frm.doc.route + '\">' + frm.doc.title + '</a></h4>';\n\t    frm.set_df_property('html_route', 'options', frappe.render_template(template));\n        frm.refresh_field('html_route');\n\t  }\n\t},\n\trefresh(frm) {\n\t  //frm.add_custom_button(__(\"Example Button\"), function() {\n      //  frappe.msgprint(\"Code Test\");\n      //}, __(\"iCode\"));\n      var template = '';\n\t  if (frm.doc.route && frm.doc.published && !frm.doc.__islocal) {\n\t    template = '<h4><a style=\"color: #4682b4; font-size: 10pt;\" href=\"' + frm.doc.route + '\">' + frm.doc.title + '</a></h4>';\n\t    frm.set_df_property('html_route', 'options', frappe.render_template(template));\n        frm.refresh_field('html_route');\n\t  }  \n\t}\n})"
 },
 {
  "docstatus": 0,
  "doctype": "Custom Script",
  "dt": "Sensor",
  "modified": "2021-01-05 11:52:31.186454",
  "name": "Sensor-Client",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sensor', {\n  setup(frm) {\n    frm.set_query(\"dashboard_chart\", function() {\n        return {\n          \"filters\": [[\"Dashboard Chart\", \"name\", \"=\", frm.doc.name]]\n        };\n    });  \n  },\n  onload(frm) {\n    show_image(frm);\n  },\n  refresh(frm) {\n    show_image(frm);\n    frm.add_custom_button(\"ReStart Sensor\", function() {\n      var shortcut = frm.doc.name;\n      var pos = shortcut.search(\"-\");\n      var action = \"start_\" + shortcut.substring(0,pos);\n      // code to be executed after button is click\n      frappe.call({\n        method: \"pibicontrol.pibicontrol.api.mqtt_command\",\n        args: {\n          host: frm.doc.hostname,\n          action: action\n        }\n      });\n    }, \"MQTT Commands\");\n    frm.add_custom_button(\"UpDate LastSeen\", function() {\n      var shortcut = frm.doc.name;\n      var pos = shortcut.search(\"-\");\n      var action = \"take_\" + shortcut.substring(0,pos);\n      // code to be executed after button is click\n      frappe.call({\n        method: \"pibicontrol.pibicontrol.api.mqtt_command\",\n        args: {\n          host: frm.doc.hostname,\n          action: action\n        }\n      });\n    }, \"MQTT Commands\");\n    // Exceptions\n    if (frm.doc.hostname == \"pbcsaas001\") {\n      frm.add_custom_button(\"Restart JitSi\", function() {\n        // code to be executed after button is click\n        frappe.call({\n          method: \"pibicontrol.pibicontrol.api.mqtt_command\",\n          args: {\n            host: frm.doc.hostname,\n            action: \"meet\"\n          }\n        });\n      }, \"MQTT Commands\");\n    }  \n    if (frm.doc.hostname == \"bi\") {\n      frm.add_custom_button(\"Restart ReDash\", function() {\n        // code to be executed after button is click\n        frappe.call({\n          method: \"pibicontrol.pibicontrol.api.mqtt_command\",\n          args: {\n            host: frm.doc.hostname,\n            action: \"redash\"\n          }\n        });\n      }, \"MQTT Commands\");\n    }\n    // Last Command\n    frm.add_custom_button(\"ReBoot Server\", function() {\n      // code to be executed after button is click\n      frappe.call({\n        method: \"pibicontrol.pibicontrol.api.mqtt_command\",\n        args: {\n          host: frm.doc.hostname,\n          action: \"boot\"\n        }\n      });\n    }, \"MQTT Commands\");\n  }\n});\nfunction show_image (frm) {\n  var path = '';\n  if (frm.doc.pictures) {\n    frappe.call({\n      method: 'pibicontrol.pibicontrol.api.get_image',\n        args: {\n\t      slide: frm.doc.pictures\n        },\n        callback: (r) => {\n          //console.log(r.message);\n          if (r.message.length >0) {\n            var rtemplate = \"\";\n            for (var j in r.message) {\n              //rtemplate += '<a href=\"' + r.message[j].image + '\" target=\"_blank\"><img style=\"border: 1px solid #4682b4; float: left; margin: 1px; padding: 1px;\" height=\"120px\" src=\"' + r.message[j].image + '\" /></a>';  \n              rtemplate += '<div class=\"card\"><a href=\"' + r.message[j].image + '\" target=\"_blank\"><img class=\"card-img-top\" style=\"border: 1px solid #4682b4; border-radius: 9px; float: left; margin: 1px; padding: 1px;\" height=\"120px\" title=\"' + r.message[j].heading + '\" src=\"' + r.message[j].image + '\" /></a></div>'; \n            }\n            //var template = '<div class=\"container-fluid\"><h4>' + frm.doc.media_library + '</h4>' + rtemplate + '</div>';\n            var template = '<div class=\"container-fluid\"><h4>Gallery</h4><div class=\"card-columns\">' + rtemplate + '</div></div>';\n            //console.log(template);\n            frm.set_df_property('gallery', 'options', frappe.render_template(template));\n            frm.refresh_field('gallery');\n          }\n        }\n    });\n  } else {\n    //console.log(frm.doc.media_library);\n    var noimage = '<div class=\"container-fluid\"><h4>No Image on Gallery</h4></div>';\n    frm.set_df_property('gallery', 'options', frappe.render_template(noimage));\n    frm.refresh_field('gallery');\n  }    \n}"
 }
]