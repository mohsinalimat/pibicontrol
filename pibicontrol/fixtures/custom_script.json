[
 {
  "docstatus": 0,
  "doctype": "Custom Script",
  "dt": "Sensor",
  "modified": "2020-12-18 17:14:58.125376",
  "name": "Sensor-Client",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sensor', {\n  setup(frm) {\n    frm.set_query(\"dashboard_chart\", function() {\n        return {\n          \"filters\": [[\"Dashboard Chart\", \"name\", \"=\", frm.doc.name]]\n        };\n    });  \n  },\n  onload(frm) {\n    show_image(frm);\n  },\n  refresh(frm) {\n    show_image(frm);\n  }\n});\nfunction show_image (frm) {\n  var path = '';\n  if (frm.doc.pictures) {\n    frappe.call({\n      method: 'pibicontrol.pibicontrol.api.get_image',\n        args: {\n\t      slide: frm.doc.pictures\n        },\n        callback: (r) => {\n          //console.log(r.message);\n          if (r.message.length >0) {\n            var rtemplate = \"\";\n            for (var j in r.message) {\n              //rtemplate += '<a href=\"' + r.message[j].image + '\" target=\"_blank\"><img style=\"border: 1px solid #4682b4; float: left; margin: 1px; padding: 1px;\" height=\"120px\" src=\"' + r.message[j].image + '\" /></a>';  \n              rtemplate += '<div class=\"card\"><a href=\"' + r.message[j].image + '\" target=\"_blank\"><img class=\"card-img-top\" style=\"border: 1px solid #4682b4; border-radius: 9px; float: left; margin: 1px; padding: 1px;\" height=\"120px\" title=\"' + r.message[j].heading + '\" src=\"' + r.message[j].image + '\" /></a></div>'; \n            }\n            //var template = '<div class=\"container-fluid\"><h4>' + frm.doc.media_library + '</h4>' + rtemplate + '</div>';\n            var template = '<div class=\"container-fluid\"><h4>Gallery</h4><div class=\"card-columns\">' + rtemplate + '</div></div>';\n            //console.log(template);\n            frm.set_df_property('gallery', 'options', frappe.render_template(template));\n            frm.refresh_field('gallery');\n          }\n        }\n    });\n  } else {\n    //console.log(frm.doc.media_library);\n    var noimage = '<div class=\"container-fluid\"><h4>No Image on Gallery</h4></div>';\n    frm.set_df_property('gallery', 'options', frappe.render_template(noimage));\n    frm.refresh_field('gallery');\n  }    \n}"
 }
]